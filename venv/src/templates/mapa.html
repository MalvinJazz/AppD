{% extends 'base.html' %}

{% block head %}
  <h1>LOCALIZACIONES</h1>
{% endblock %}

{% block content %}
<div id="sectionMap">
  <div id="map"></div>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript">
  var map;

  function initMap() {
    if (navigator.geolocation) {
		    navigator.geolocation.getCurrentPosition(function(position){

          var lt = position.coords.latitude;
          var lon = position.coords.longitude;

          var myLatlng = new google.maps.LatLng(lt,lon);

          map = new google.maps.Map(document.getElementById('map'), {
            center: myLatlng,
            zoom: 15
          });

          {% for dato in denuncias %}
            loc = {lat: {{dato.latitud}}, lng: {{dato.longitud}}};
            addMarker(loc, map, '{{dato.motivo}}', {{dato.getSprite}});
          {% endfor %}

        });





		} else {
			alert("Para utilizar la geolocalizaci√≥n necesitas actualizar tu navegador.");
		}
  }

  function addMarker(loc, map, title, sprite){

    var image = {
      url: '/static/images/marcadores.png',
      size: new google.maps.Size(36,46),
      origin: new google.maps.Point(sprite,0),
      anchor: new google.maps.Point(0,46)
    };

    var marker = new google.maps.Marker({
    position: loc,
    title: title,
    map: map,
    icon: image
    });
  }

</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPIn8C1d9dQLNNnv-Z2D0AKz6WESeZ8tI&callback=initMap"
    async defer></script>
{% endblock %}


<!-- AIzaSyAPIn8C1d9dQLNNnv-Z2D0AKz6WESeZ8tI -->
